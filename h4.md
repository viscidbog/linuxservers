# Maailma kuulee

## x) Yleistä pilvipalvelimien käytöstä

Pilvipalvelimen vuokraus toimii siten, että vuokrataan virtuaalikone palveluntarjoajalta ja halutessaan domain-nimi niitä tarjoavalta toimijalta.

Em. palvelimen käyttö onnistuu parhaiten SSH-yhteydellä, koska se toimii missä tahansa palvelimessa samalla tavalla.

Kun tämä on tehty, tehdään yleiset asiat kuten pakettien päivitys, palomuuri sekä tehdään käyttäjätunnukset itselle.

## a) Pilvipalvelimen vuokraus sekä b) alkutoimet

Käytän UpCloudin ilmaisen viikon tarjouksen ja vuokraan heiltä. Uutta palvelinta tehdessä salasanan käyttö ei ollut edes vaihtoehto, joten mennään SSH-avaimella:

<img width="1118" height="649" alt="image" src="https://github.com/user-attachments/assets/1a63e291-7fc9-44d5-ac62-ce47d4270abe" />

<br></br>

Ja näin saadaan palvelin pystyyn:

<img width="1158" height="570" alt="Näyttökuva 2025-09-15 120535" src="https://github.com/user-attachments/assets/e556dab7-6f67-4823-b265-81fbe28e8f4d" />

<br></br>

Otetaan SSH-yhteys palvelimeen rootilla:

<img width="822" height="180" alt="image" src="https://github.com/user-attachments/assets/8319503f-838b-4c9f-9879-4501ac95edc7" />

<br></br>

Asennetaan palomuuri, tehdään siihen reikä ja laitetaan päälle:

<img width="822" height="131" alt="image" src="https://github.com/user-attachments/assets/a3ca6f9b-ddda-4c6a-94c5-1d63de361c4e" />

<br></br>

Tehdään uusi käyttäjä:

(Tässä saatu errori liittyy localeasetuksiin.)
<img width="824" height="669" alt="image" src="https://github.com/user-attachments/assets/c14bf3c5-4320-4589-9940-4446d63aec24" />

<br></br>

Lisätessä oikeuksia saatiin sudo- ja adm-oikeudet käyttäjälle, mutta adminia lisätessä tuli errori, eli sitä grouppia ei siis virtuaalipalvelimella ole:

<img width="821" height="418" alt="image" src="https://github.com/user-attachments/assets/adf1e8a5-b96b-4b60-a2ec-c5d7ee1fc742" />

<br></br>

Ja uudella käyttäjällä yritettäessä SSH-yhteyttä, se ei toimi:

<img width="532" height="64" alt="Näyttökuva 2025-09-15 123157" src="https://github.com/user-attachments/assets/dd09bc0d-04cf-4a81-a581-58df413325bf" />

<br></br>

Tajutaan, että oikeudet unohtui kopioida rootilta:

<img width="824" height="99" alt="image" src="https://github.com/user-attachments/assets/df17fa12-5527-46ac-b749-53c7a8bd57f6" />

<br></br>

Ja nyt päästään uudella käyttäjällä SSH-yhteydellä sisään:

<img width="814" height="214" alt="Näyttökuva 2025-09-15 125805" src="https://github.com/user-attachments/assets/7d26f075-ad84-42a7-8093-8581a98ff33e" />

<br></br>

Lopuksi lukitaan root-tunnus:

<img width="827" height="104" alt="image" src="https://github.com/user-attachments/assets/04ab90ec-cb97-4bbe-a49f-032a0dd43dc6" />

<br></br>

Ja tehdään apt-get update sekä upgrade päivittääksemme paketit ja lopuksi rebootataan serveri ja logataan takaisin sisään, jotta nähdään toimiko:

<img width="819" height="286" alt="Näyttökuva 2025-09-15 130339" src="https://github.com/user-attachments/assets/347f8420-1e17-4d48-a1fd-ba69f1be6af0" />

## c) Web-palvelin

Asensin ja käynnistin apachen. Ensin ei meinannut sivu netissä näkyä, mutta sitten tajusin unohtaneeni avata palomuurista sille reiän:

<img width="817" height="233" alt="image" src="https://github.com/user-attachments/assets/be5836c1-935a-4fb1-87c6-f4a5ef3033ce" />

<br></br>

Ja tämän jälkeen apachen default-sivu näkyykin:

<img width="1012" height="390" alt="image" src="https://github.com/user-attachments/assets/8b89b065-2440-4fc0-9773-4148ec310e48" />

<br></br>

Sitten korvataan default-sivu omalla:

<img width="820" height="87" alt="image" src="https://github.com/user-attachments/assets/ead6d81e-d643-4090-a842-e9d32566c4c9" />

<br></br>

Ja sivu näkyy, tavallaan. Skandit eivät oikein toimineet:

<img width="355" height="61" alt="image" src="https://github.com/user-attachments/assets/5f2077b4-fcb6-432b-bc01-9ff79f8efea1" />

<br></br>

Tiedostosta puuttui tägi, jolla saadaan ne toimimaan. Unohtui, että html-tiedostossa pitää se määritellä. Lisäämällä `<meta charset="UTF-8">` skandit ja muut erikoismerkit toimivat:

<img width="371" height="181" alt="image" src="https://github.com/user-attachments/assets/8f43b153-7885-4dd1-be26-39c854a3bdc4" />

(Tässä samalla tajusin, että ihan turhaan olin sensuroinut serverin IP-osoitteen kuvista, sillä onhan se parempi muidenkin päästä sitä kokeilemaan.)

<br></br>

Ylempänä saadut errorit localesta piti sitten nekin mennä korjaamaan. Screenshotteja en ottanut tilanteen ollessa ns. päällä, joten tehdään tämä näin jälkeen päin:

Kirjoitetaan `locale`:

<img width="580" height="395" alt="image" src="https://github.com/user-attachments/assets/0e71ef85-de42-4967-8407-9359bc4011aa" />

Jos ensimmäiset kaksi (LANG ja LANGUAGE) ovat tyhjiä tai niissä on jotain muuta kuin `fi_FI.UTF-8`, niin:

Asennetaan locales varmuuden vuoksi:
`sudo apt-get install locales -y`

Generoidaan suomen kieli:
`sudo locale-gen fi_FI.UTF-8`

Jos ei suostu generoimaan, niin käynnistetään localen asetusten säätö:

`sudo dpkg-reconfigure locales`

Täältä sitten selataan ja laitetaan SPACEBARILLA PAINAMALLA halutut kielet päälle, eli `en_US` ja `fi_FI`. Jos menit painamaan enteriä luullen, että sillä valitaan,
niin saat käynnistellä tämän uudestaan. Ei kannata myöskään laittaa kaikkia kieliä generoitumaan. Vie aikaa yllättävän pitkään:

<img width="826" height="652" alt="image" src="https://github.com/user-attachments/assets/b5c28d4d-b836-4b38-ae8c-31934c03b13e" />

<br></br>

Painamalla enteriä päästään seuraavaan valikkoon, josta halutessa voi valita oletuskielen. Edelleen sillä spacebarilla:

<img width="823" height="658" alt="image" src="https://github.com/user-attachments/assets/5f7b7d66-ec89-43db-99e7-43002de4dbf7" />

<br></br>

Lopuksi vaihdetaan kieli localen kahteen ekaan kohtaan:

`sudo update-locale LANGUAGE=fi_FI.UTF-8`

ja

`sudo update-locale LANG=fi_FI.UTF-8`

Tämän voi tarkistaa toimineen kirjoittamalla `locale`.

## Lähteet

- https://terokarvinen.com/2017/first-steps-on-a-new-virtual-private-server-an-example-on-digitalocean/
- https://susannalehto.fi/2022/teoriasta-kaytantoon-pilvipalvelimen-avulla-h4/
- https://www.digitalocean.com/community/tutorials/how-to-configure-ssh-key-based-authentication-on-a-linux-server
